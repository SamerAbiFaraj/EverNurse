{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/EverNurse-Project/evernurse-cv-matcher/src/services/embeddingService.ts"],"sourcesContent":["import OpenAI from 'openai';\r\n\r\n// Initialize OpenAI client\r\nconst openai = new OpenAI({\r\n    apiKey: process.env.OPENAI_API_KEY,\r\n});\r\n\r\nexport class EmbeddingService {\r\n    /**\r\n     * Generate embedding vector for text using OpenAI's text-embedding-3-small model\r\n     */\r\n    static async generateEmbedding(text: string): Promise<number[]> {\r\n        try {\r\n            console.log('üß† Generating embedding for text (length:', text.length, 'chars)');\r\n\r\n            // Truncate text if too long (max ~8000 tokens ‚âà 32000 chars)\r\n            const truncatedText = text.substring(0, 32000);\r\n\r\n            const response = await openai.embeddings.create({\r\n                model: 'text-embedding-3-small',\r\n                input: truncatedText,\r\n            });\r\n\r\n            const embedding = response.data[0].embedding;\r\n            console.log('‚úÖ Embedding generated (dimensions:', embedding.length, ')');\r\n\r\n            return embedding;\r\n        } catch (error) {\r\n            console.error('‚ùå Embedding generation failed:', error);\r\n            throw new Error(`Failed to generate embedding: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Calculate cosine similarity between two embedding vectors\r\n     * Returns a value between -1 and 1, where 1 means identical, 0 means orthogonal, -1 means opposite\r\n     */\r\n    static calculateCosineSimilarity(vec1: number[], vec2: number[]): number {\r\n        if (vec1.length !== vec2.length) {\r\n            throw new Error('Vectors must have the same dimensions');\r\n        }\r\n\r\n        let dotProduct = 0;\r\n        let norm1 = 0;\r\n        let norm2 = 0;\r\n\r\n        for (let i = 0; i < vec1.length; i++) {\r\n            dotProduct += vec1[i] * vec2[i];\r\n            norm1 += vec1[i] * vec1[i];\r\n            norm2 += vec2[i] * vec2[i];\r\n        }\r\n\r\n        const magnitude = Math.sqrt(norm1) * Math.sqrt(norm2);\r\n\r\n        if (magnitude === 0) {\r\n            return 0;\r\n        }\r\n\r\n        const similarity = dotProduct / magnitude;\r\n\r\n        console.log('üìä Cosine similarity:', similarity.toFixed(4));\r\n\r\n        return similarity;\r\n    }\r\n\r\n    /**\r\n     * Prepare text for embedding generation by combining relevant fields\r\n     */\r\n    static prepareJobText(job: any): string {\r\n        const parts = [\r\n            job.title || '',\r\n            job.description || '',\r\n            job.department || '',\r\n            job.location || '',\r\n            (job.requiredSkills || []).join(', '),\r\n            (job.requiredLicenses || []).join(', '),\r\n            job.requirements ? (Array.isArray(job.requirements) ? job.requirements.join(', ') : job.requirements) : ''\r\n        ];\r\n\r\n        return parts.filter(p => p).join('\\n');\r\n    }\r\n\r\n    /**\r\n     * Prepare candidate text for embedding generation\r\n     */\r\n    static prepareCandidateText(candidate: any): string {\r\n        const parts = [\r\n            candidate.name || '',\r\n            `${candidate.experience || 0} years of experience`,\r\n            (candidate.skills || []).join(', '),\r\n            (candidate.licenses || []).join(', '),\r\n            candidate.location || '',\r\n            candidate.rawText || ''\r\n        ];\r\n\r\n        return parts.filter(p => p).join('\\n');\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;;AAEA,2BAA2B;AAC3B,MAAM,SAAS,IAAI,mLAAM,CAAC;IACtB,QAAQ,QAAQ,GAAG,CAAC,cAAc;AACtC;AAEO,MAAM;IACT;;KAEC,GACD,aAAa,kBAAkB,IAAY,EAAqB;QAC5D,IAAI;YACA,QAAQ,GAAG,CAAC,6CAA6C,KAAK,MAAM,EAAE;YAEtE,6DAA6D;YAC7D,MAAM,gBAAgB,KAAK,SAAS,CAAC,GAAG;YAExC,MAAM,WAAW,MAAM,OAAO,UAAU,CAAC,MAAM,CAAC;gBAC5C,OAAO;gBACP,OAAO;YACX;YAEA,MAAM,YAAY,SAAS,IAAI,CAAC,EAAE,CAAC,SAAS;YAC5C,QAAQ,GAAG,CAAC,sCAAsC,UAAU,MAAM,EAAE;YAEpE,OAAO;QACX,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,kCAAkC;YAChD,MAAM,IAAI,MAAM,CAAC,8BAA8B,EAAE,iBAAiB,QAAQ,MAAM,OAAO,GAAG,iBAAiB;QAC/G;IACJ;IAEA;;;KAGC,GACD,OAAO,0BAA0B,IAAc,EAAE,IAAc,EAAU;QACrE,IAAI,KAAK,MAAM,KAAK,KAAK,MAAM,EAAE;YAC7B,MAAM,IAAI,MAAM;QACpB;QAEA,IAAI,aAAa;QACjB,IAAI,QAAQ;QACZ,IAAI,QAAQ;QAEZ,IAAK,IAAI,IAAI,GAAG,IAAI,KAAK,MAAM,EAAE,IAAK;YAClC,cAAc,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE;YAC/B,SAAS,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE;YAC1B,SAAS,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE;QAC9B;QAEA,MAAM,YAAY,KAAK,IAAI,CAAC,SAAS,KAAK,IAAI,CAAC;QAE/C,IAAI,cAAc,GAAG;YACjB,OAAO;QACX;QAEA,MAAM,aAAa,aAAa;QAEhC,QAAQ,GAAG,CAAC,yBAAyB,WAAW,OAAO,CAAC;QAExD,OAAO;IACX;IAEA;;KAEC,GACD,OAAO,eAAe,GAAQ,EAAU;QACpC,MAAM,QAAQ;YACV,IAAI,KAAK,IAAI;YACb,IAAI,WAAW,IAAI;YACnB,IAAI,UAAU,IAAI;YAClB,IAAI,QAAQ,IAAI;YAChB,CAAC,IAAI,cAAc,IAAI,EAAE,EAAE,IAAI,CAAC;YAChC,CAAC,IAAI,gBAAgB,IAAI,EAAE,EAAE,IAAI,CAAC;YAClC,IAAI,YAAY,GAAI,MAAM,OAAO,CAAC,IAAI,YAAY,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,QAAQ,IAAI,YAAY,GAAI;SAC3G;QAED,OAAO,MAAM,MAAM,CAAC,CAAA,IAAK,GAAG,IAAI,CAAC;IACrC;IAEA;;KAEC,GACD,OAAO,qBAAqB,SAAc,EAAU;QAChD,MAAM,QAAQ;YACV,UAAU,IAAI,IAAI;YAClB,GAAG,UAAU,UAAU,IAAI,EAAE,oBAAoB,CAAC;YAClD,CAAC,UAAU,MAAM,IAAI,EAAE,EAAE,IAAI,CAAC;YAC9B,CAAC,UAAU,QAAQ,IAAI,EAAE,EAAE,IAAI,CAAC;YAChC,UAAU,QAAQ,IAAI;YACtB,UAAU,OAAO,IAAI;SACxB;QAED,OAAO,MAAM,MAAM,CAAC,CAAA,IAAK,GAAG,IAAI,CAAC;IACrC;AACJ"}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"sources":["file:///C:/EverNurse-Project/evernurse-cv-matcher/src/app/api/matching/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { readFile, writeFile } from 'fs/promises';\r\nimport { EmbeddingService } from '../../../services/embeddingService';\r\n\r\n// Helper function to get jobs from database\r\nasync function getActiveJobs() {\r\n    try {\r\n        const db = await readFile('./uploads/database.json', 'utf-8');\r\n        const database = JSON.parse(db);\r\n\r\n        // Get active jobs from database\r\n        const jobs = database.jobs?.filter((job: any) => job.isActive !== false) || [];\r\n\r\n        // If no jobs in database, return default mock jobs for backward compatibility\r\n        if (jobs.length === 0) {\r\n            console.log('‚ö†Ô∏è No jobs in database, using fallback mock jobs');\r\n            return [\r\n                {\r\n                    id: 'job-1',\r\n                    title: 'Registered Nurse - ICU',\r\n                    department: 'Critical Care',\r\n                    location: 'Dubai',\r\n                    requiredSkills: ['ICU', 'Emergency Care', 'Patient Assessment'],\r\n                    requiredLicenses: ['DHA', 'DOH'],\r\n                    minExperience: 3,\r\n                    description: 'ICU Nurse with critical care experience'\r\n                },\r\n                {\r\n                    id: 'job-2',\r\n                    title: 'Pediatric Nurse',\r\n                    department: 'Pediatrics',\r\n                    location: 'Abu Dhabi',\r\n                    requiredSkills: ['Pediatrics', 'Patient Care'],\r\n                    requiredLicenses: ['DOH', 'MOH'],\r\n                    minExperience: 2,\r\n                    description: 'Pediatric nurse for children hospital'\r\n                }\r\n            ];\r\n        }\r\n\r\n        return jobs;\r\n    } catch (error) {\r\n        console.error('‚ùå Error loading jobs:', error);\r\n        return [];\r\n    }\r\n}\r\n\r\nclass MatchingEngine {\r\n    static async calculateMatch(candidate: any, job: any) {\r\n        let score = 0;\r\n        const reasons = [];\r\n\r\n        // 1. Experience match (25 points max)\r\n        const minExperience = job.minExperience || 0;\r\n\r\n        if (minExperience === 0) {\r\n            // If no experience required, give full points if candidate has ANY experience\r\n            // or if they just meet the \"0\" requirement.\r\n            score += 25;\r\n            reasons.push('Experience: Met (No minimum required)');\r\n        } else if (candidate.experience >= minExperience) {\r\n            // If they meet the non-zero requirement\r\n            // Base score 15, plus up to 10 for exceeding\r\n            const ratio = candidate.experience / minExperience;\r\n            const expScore = Math.min(25, 15 + (ratio - 1) * 10);\r\n            score += expScore;\r\n            reasons.push(`Experience: ${candidate.experience} years (Required: ${minExperience})`);\r\n        } else {\r\n            // Partial score for being close\r\n            const ratio = candidate.experience / minExperience;\r\n            const expScore = ratio * 15; // Max 15 if under qualified\r\n            score += expScore;\r\n            reasons.push(`Experience: ${candidate.experience} years (Under qualified)`);\r\n        }\r\n\r\n        // 2. Structured Skills match (20 points max)\r\n        let skillsScore = 0;\r\n        const matchedSkills = candidate.skills.filter((skill: string) =>\r\n            job.requiredSkills.some((reqSkill: string) =>\r\n                reqSkill.toLowerCase().includes(skill.toLowerCase()) ||\r\n                skill.toLowerCase().includes(reqSkill.toLowerCase())\r\n            )\r\n        );\r\n\r\n        if (job.requiredSkills.length === 0) {\r\n            // If no specific skills required, give full points\r\n            score += 20;\r\n            reasons.push('Skills: Met (No specific skills required)');\r\n        } else if (matchedSkills.length > 0) {\r\n            skillsScore = (matchedSkills.length / job.requiredSkills.length) * 20;\r\n            skillsScore = Math.min(20, skillsScore);\r\n            score += skillsScore;\r\n            reasons.push(`Skills: ${matchedSkills.join(', ')}`);\r\n        }\r\n\r\n        // 3. License match (25 points max)\r\n        let licenseScore = 0;\r\n        const matchedLicenses = candidate.licenses.filter((license: string) =>\r\n            job.requiredLicenses.includes(license)\r\n        );\r\n\r\n        if (job.requiredLicenses.length === 0) {\r\n            // If no licenses required, give full points\r\n            score += 25;\r\n            reasons.push('Licenses: Met (None required)');\r\n        } else if (matchedLicenses.length > 0) {\r\n            licenseScore = (matchedLicenses.length / job.requiredLicenses.length) * 25;\r\n            score += licenseScore;\r\n            reasons.push(`Licenses: ${matchedLicenses.join(', ')}`);\r\n        }\r\n\r\n        // 4. Semantic Similarity (30 points max)\r\n        try {\r\n            let jobEmbedding = job.embedding;\r\n            let candidateEmbedding = candidate.embedding;\r\n\r\n            // Generate embeddings if missing\r\n            if (!jobEmbedding) {\r\n                const jobText = EmbeddingService.prepareJobText(job);\r\n                jobEmbedding = await EmbeddingService.generateEmbedding(jobText);\r\n                job.embedding = jobEmbedding;\r\n            }\r\n\r\n            if (!candidateEmbedding) {\r\n                const candidateText = EmbeddingService.prepareCandidateText(candidate);\r\n                candidateEmbedding = await EmbeddingService.generateEmbedding(candidateText);\r\n                candidate.embedding = candidateEmbedding;\r\n            }\r\n\r\n            const similarity = EmbeddingService.calculateCosineSimilarity(jobEmbedding, candidateEmbedding);\r\n\r\n            // Convert similarity to score\r\n            // We assume relevant matches have similarity > 0.5\r\n            let semanticScore = 0;\r\n            if (similarity > 0.5) {\r\n                // Normalize 0.5-1.0 range to 0-30 points\r\n                semanticScore = ((similarity - 0.5) / 0.5) * 30;\r\n            }\r\n\r\n            score += semanticScore;\r\n\r\n            if (semanticScore > 5) {\r\n                reasons.push(`AI Semantic Match: ${Math.round(similarity * 100)}%`);\r\n            }\r\n\r\n        } catch (error) {\r\n            console.error('‚ö†Ô∏è Semantic matching failed:', error);\r\n            // Fallback\r\n            if (job.requiredSkills.length === 0) {\r\n                const descriptionScore = this.analyzeJobDescription(candidate, job);\r\n                score += descriptionScore.score;\r\n                if (descriptionScore.keywords.length > 0) {\r\n                    reasons.push(`Matched keywords (Fallback): ${descriptionScore.keywords.join(', ')}`);\r\n                }\r\n            }\r\n        }\r\n\r\n        return {\r\n            score: Math.min(100, Math.round(score)),\r\n            reasons,\r\n            matchedSkills,\r\n            missingRequirements: this.findMissingRequirements(candidate, job)\r\n        };\r\n    }\r\n\r\n    static analyzeJobDescription(candidate: any, job: any) {\r\n        // Extract keywords from job title and description\r\n        const jobText = `${job.title} ${job.description}`.toLowerCase();\r\n        const candidateText = candidate.rawText.toLowerCase();\r\n\r\n        // Common keywords to look for\r\n        const keywords = [\r\n            'project management', 'banking', 'credit card', 'fintech', 'it', 'software',\r\n            'development', 'database', 'cloud', 'leadership', 'management', 'strategy',\r\n            'planning', 'agile', 'scrum', 'api', 'integration', 'consulting',\r\n            'nursing', 'healthcare', 'patient care', 'clinical', 'emergency'\r\n        ];\r\n\r\n        const matchedKeywords: string[] = [];\r\n        let keywordMatches = 0;\r\n\r\n        for (const keyword of keywords) {\r\n            if (jobText.includes(keyword) && candidateText.includes(keyword)) {\r\n                matchedKeywords.push(keyword);\r\n                keywordMatches++;\r\n            }\r\n        }\r\n\r\n        // Also check if candidate skills appear in job description\r\n        for (const skill of candidate.skills) {\r\n            if (jobText.includes(skill.toLowerCase()) && !matchedKeywords.includes(skill.toLowerCase())) {\r\n                matchedKeywords.push(skill);\r\n                keywordMatches++;\r\n            }\r\n        }\r\n\r\n        // Calculate score: up to 30 points\r\n        const score = Math.min(30, keywordMatches * 6);\r\n\r\n        return {\r\n            score,\r\n            keywords: matchedKeywords.slice(0, 5) // Limit to top 5 for display\r\n        };\r\n    }\r\n\r\n    static findMissingRequirements(candidate: any, job: any) {\r\n        const missing = [];\r\n\r\n        if (candidate.experience < (job.minExperience || 0)) {\r\n            missing.push(`Needs ${job.minExperience - candidate.experience} more years experience`);\r\n        }\r\n\r\n        const missingLicenses = job.requiredLicenses.filter((license: string) =>\r\n            !candidate.licenses.includes(license)\r\n        );\r\n\r\n        if (missingLicenses.length > 0) {\r\n            missing.push(`Missing licenses: ${missingLicenses.join(', ')}`);\r\n        }\r\n\r\n        return missing;\r\n    }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const { candidateId } = await request.json();\r\n\r\n        if (!candidateId) {\r\n            return NextResponse.json({ error: 'Candidate ID required' }, { status: 400 });\r\n        }\r\n\r\n        // Read database\r\n        const dbContent = await readFile('./uploads/database.json', 'utf-8');\r\n        const database = JSON.parse(dbContent);\r\n\r\n        // Find candidate\r\n        const candidate = database.candidates.find((c: any) => c.id === candidateId);\r\n\r\n        if (!candidate) {\r\n            return NextResponse.json({ error: 'Candidate not found' }, { status: 404 });\r\n        }\r\n\r\n        console.log(`üéØ Matching candidate: ${candidate.name}`);\r\n\r\n        // Get active jobs from database\r\n        const jobs = await getActiveJobs();\r\n\r\n        if (jobs.length === 0) {\r\n            console.log('‚ö†Ô∏è No active jobs available for matching');\r\n            return NextResponse.json({\r\n                success: true,\r\n                candidate: candidate.name,\r\n                matches: [],\r\n                message: 'No active jobs available for matching'\r\n            });\r\n        }\r\n\r\n        // Calculate matches with all jobs\r\n        const matches = await Promise.all(jobs.map(async (job: any) => {\r\n            const matchResult = await MatchingEngine.calculateMatch(candidate, job);\r\n\r\n            return {\r\n                jobId: job.id,\r\n                jobTitle: job.title,\r\n                department: job.department,\r\n                location: job.location,\r\n                ...matchResult\r\n            };\r\n        }));\r\n\r\n        // Update database with any new embeddings generated during matching\r\n        let dbUpdated = false;\r\n\r\n        // Update candidate embedding\r\n        const dbCandidate = database.candidates.find((c: any) => c.id === candidateId);\r\n        if (candidate.embedding && (!dbCandidate.embedding || dbCandidate.embedding.length === 0)) {\r\n            dbCandidate.embedding = candidate.embedding;\r\n            dbUpdated = true;\r\n        }\r\n\r\n        // Update job embeddings\r\n        jobs.forEach((job: any) => {\r\n            const dbJob = database.jobs.find((j: any) => j.id === job.id);\r\n            if (job.embedding && dbJob && (!dbJob.embedding || dbJob.embedding.length === 0)) {\r\n                dbJob.embedding = job.embedding;\r\n                dbUpdated = true;\r\n            }\r\n        });\r\n\r\n        // Store matches in database\r\n        if (!database.matches) database.matches = [];\r\n\r\n        matches.forEach(match => {\r\n            database.matches.push({\r\n                id: `match-${Date.now()}-${match.jobId}`,\r\n                candidateId: candidate.id,\r\n                ...match,\r\n                matchedAt: new Date().toISOString()\r\n            });\r\n        });\r\n\r\n        // Save database\r\n        await writeFile('./uploads/database.json', JSON.stringify(database, null, 2));\r\n\r\n        console.log(`‚úÖ Found ${matches.length} potential matches for ${candidate.name}`);\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            candidate: candidate.name,\r\n            matches,\r\n            message: `Found ${matches.length} potential job matches`\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('‚ùå Matching error:', error);\r\n        return NextResponse.json(\r\n            { error: 'Matching failed' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,4CAA4C;AAC5C,eAAe;IACX,IAAI;QACA,MAAM,KAAK,MAAM,IAAA,iIAAQ,EAAC,2BAA2B;QACrD,MAAM,WAAW,KAAK,KAAK,CAAC;QAE5B,gCAAgC;QAChC,MAAM,OAAO,SAAS,IAAI,EAAE,OAAO,CAAC,MAAa,IAAI,QAAQ,KAAK,UAAU,EAAE;QAE9E,8EAA8E;QAC9E,IAAI,KAAK,MAAM,KAAK,GAAG;YACnB,QAAQ,GAAG,CAAC;YACZ,OAAO;gBACH;oBACI,IAAI;oBACJ,OAAO;oBACP,YAAY;oBACZ,UAAU;oBACV,gBAAgB;wBAAC;wBAAO;wBAAkB;qBAAqB;oBAC/D,kBAAkB;wBAAC;wBAAO;qBAAM;oBAChC,eAAe;oBACf,aAAa;gBACjB;gBACA;oBACI,IAAI;oBACJ,OAAO;oBACP,YAAY;oBACZ,UAAU;oBACV,gBAAgB;wBAAC;wBAAc;qBAAe;oBAC9C,kBAAkB;wBAAC;wBAAO;qBAAM;oBAChC,eAAe;oBACf,aAAa;gBACjB;aACH;QACL;QAEA,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,EAAE;IACb;AACJ;AAEA,MAAM;IACF,aAAa,eAAe,SAAc,EAAE,GAAQ,EAAE;QAClD,IAAI,QAAQ;QACZ,MAAM,UAAU,EAAE;QAElB,sCAAsC;QACtC,MAAM,gBAAgB,IAAI,aAAa,IAAI;QAE3C,IAAI,kBAAkB,GAAG;YACrB,8EAA8E;YAC9E,4CAA4C;YAC5C,SAAS;YACT,QAAQ,IAAI,CAAC;QACjB,OAAO,IAAI,UAAU,UAAU,IAAI,eAAe;YAC9C,wCAAwC;YACxC,6CAA6C;YAC7C,MAAM,QAAQ,UAAU,UAAU,GAAG;YACrC,MAAM,WAAW,KAAK,GAAG,CAAC,IAAI,KAAK,CAAC,QAAQ,CAAC,IAAI;YACjD,SAAS;YACT,QAAQ,IAAI,CAAC,CAAC,YAAY,EAAE,UAAU,UAAU,CAAC,kBAAkB,EAAE,cAAc,CAAC,CAAC;QACzF,OAAO;YACH,gCAAgC;YAChC,MAAM,QAAQ,UAAU,UAAU,GAAG;YACrC,MAAM,WAAW,QAAQ,IAAI,4BAA4B;YACzD,SAAS;YACT,QAAQ,IAAI,CAAC,CAAC,YAAY,EAAE,UAAU,UAAU,CAAC,wBAAwB,CAAC;QAC9E;QAEA,6CAA6C;QAC7C,IAAI,cAAc;QAClB,MAAM,gBAAgB,UAAU,MAAM,CAAC,MAAM,CAAC,CAAC,QAC3C,IAAI,cAAc,CAAC,IAAI,CAAC,CAAC,WACrB,SAAS,WAAW,GAAG,QAAQ,CAAC,MAAM,WAAW,OACjD,MAAM,WAAW,GAAG,QAAQ,CAAC,SAAS,WAAW;QAIzD,IAAI,IAAI,cAAc,CAAC,MAAM,KAAK,GAAG;YACjC,mDAAmD;YACnD,SAAS;YACT,QAAQ,IAAI,CAAC;QACjB,OAAO,IAAI,cAAc,MAAM,GAAG,GAAG;YACjC,cAAc,AAAC,cAAc,MAAM,GAAG,IAAI,cAAc,CAAC,MAAM,GAAI;YACnE,cAAc,KAAK,GAAG,CAAC,IAAI;YAC3B,SAAS;YACT,QAAQ,IAAI,CAAC,CAAC,QAAQ,EAAE,cAAc,IAAI,CAAC,OAAO;QACtD;QAEA,mCAAmC;QACnC,IAAI,eAAe;QACnB,MAAM,kBAAkB,UAAU,QAAQ,CAAC,MAAM,CAAC,CAAC,UAC/C,IAAI,gBAAgB,CAAC,QAAQ,CAAC;QAGlC,IAAI,IAAI,gBAAgB,CAAC,MAAM,KAAK,GAAG;YACnC,4CAA4C;YAC5C,SAAS;YACT,QAAQ,IAAI,CAAC;QACjB,OAAO,IAAI,gBAAgB,MAAM,GAAG,GAAG;YACnC,eAAe,AAAC,gBAAgB,MAAM,GAAG,IAAI,gBAAgB,CAAC,MAAM,GAAI;YACxE,SAAS;YACT,QAAQ,IAAI,CAAC,CAAC,UAAU,EAAE,gBAAgB,IAAI,CAAC,OAAO;QAC1D;QAEA,yCAAyC;QACzC,IAAI;YACA,IAAI,eAAe,IAAI,SAAS;YAChC,IAAI,qBAAqB,UAAU,SAAS;YAE5C,iCAAiC;YACjC,IAAI,CAAC,cAAc;gBACf,MAAM,UAAU,yJAAgB,CAAC,cAAc,CAAC;gBAChD,eAAe,MAAM,yJAAgB,CAAC,iBAAiB,CAAC;gBACxD,IAAI,SAAS,GAAG;YACpB;YAEA,IAAI,CAAC,oBAAoB;gBACrB,MAAM,gBAAgB,yJAAgB,CAAC,oBAAoB,CAAC;gBAC5D,qBAAqB,MAAM,yJAAgB,CAAC,iBAAiB,CAAC;gBAC9D,UAAU,SAAS,GAAG;YAC1B;YAEA,MAAM,aAAa,yJAAgB,CAAC,yBAAyB,CAAC,cAAc;YAE5E,8BAA8B;YAC9B,mDAAmD;YACnD,IAAI,gBAAgB;YACpB,IAAI,aAAa,KAAK;gBAClB,yCAAyC;gBACzC,gBAAgB,AAAC,CAAC,aAAa,GAAG,IAAI,MAAO;YACjD;YAEA,SAAS;YAET,IAAI,gBAAgB,GAAG;gBACnB,QAAQ,IAAI,CAAC,CAAC,mBAAmB,EAAE,KAAK,KAAK,CAAC,aAAa,KAAK,CAAC,CAAC;YACtE;QAEJ,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,gCAAgC;YAC9C,WAAW;YACX,IAAI,IAAI,cAAc,CAAC,MAAM,KAAK,GAAG;gBACjC,MAAM,mBAAmB,IAAI,CAAC,qBAAqB,CAAC,WAAW;gBAC/D,SAAS,iBAAiB,KAAK;gBAC/B,IAAI,iBAAiB,QAAQ,CAAC,MAAM,GAAG,GAAG;oBACtC,QAAQ,IAAI,CAAC,CAAC,6BAA6B,EAAE,iBAAiB,QAAQ,CAAC,IAAI,CAAC,OAAO;gBACvF;YACJ;QACJ;QAEA,OAAO;YACH,OAAO,KAAK,GAAG,CAAC,KAAK,KAAK,KAAK,CAAC;YAChC;YACA;YACA,qBAAqB,IAAI,CAAC,uBAAuB,CAAC,WAAW;QACjE;IACJ;IAEA,OAAO,sBAAsB,SAAc,EAAE,GAAQ,EAAE;QACnD,kDAAkD;QAClD,MAAM,UAAU,GAAG,IAAI,KAAK,CAAC,CAAC,EAAE,IAAI,WAAW,EAAE,CAAC,WAAW;QAC7D,MAAM,gBAAgB,UAAU,OAAO,CAAC,WAAW;QAEnD,8BAA8B;QAC9B,MAAM,WAAW;YACb;YAAsB;YAAW;YAAe;YAAW;YAAM;YACjE;YAAe;YAAY;YAAS;YAAc;YAAc;YAChE;YAAY;YAAS;YAAS;YAAO;YAAe;YACpD;YAAW;YAAc;YAAgB;YAAY;SACxD;QAED,MAAM,kBAA4B,EAAE;QACpC,IAAI,iBAAiB;QAErB,KAAK,MAAM,WAAW,SAAU;YAC5B,IAAI,QAAQ,QAAQ,CAAC,YAAY,cAAc,QAAQ,CAAC,UAAU;gBAC9D,gBAAgB,IAAI,CAAC;gBACrB;YACJ;QACJ;QAEA,2DAA2D;QAC3D,KAAK,MAAM,SAAS,UAAU,MAAM,CAAE;YAClC,IAAI,QAAQ,QAAQ,CAAC,MAAM,WAAW,OAAO,CAAC,gBAAgB,QAAQ,CAAC,MAAM,WAAW,KAAK;gBACzF,gBAAgB,IAAI,CAAC;gBACrB;YACJ;QACJ;QAEA,mCAAmC;QACnC,MAAM,QAAQ,KAAK,GAAG,CAAC,IAAI,iBAAiB;QAE5C,OAAO;YACH;YACA,UAAU,gBAAgB,KAAK,CAAC,GAAG,GAAG,6BAA6B;QACvE;IACJ;IAEA,OAAO,wBAAwB,SAAc,EAAE,GAAQ,EAAE;QACrD,MAAM,UAAU,EAAE;QAElB,IAAI,UAAU,UAAU,GAAG,CAAC,IAAI,aAAa,IAAI,CAAC,GAAG;YACjD,QAAQ,IAAI,CAAC,CAAC,MAAM,EAAE,IAAI,aAAa,GAAG,UAAU,UAAU,CAAC,sBAAsB,CAAC;QAC1F;QAEA,MAAM,kBAAkB,IAAI,gBAAgB,CAAC,MAAM,CAAC,CAAC,UACjD,CAAC,UAAU,QAAQ,CAAC,QAAQ,CAAC;QAGjC,IAAI,gBAAgB,MAAM,GAAG,GAAG;YAC5B,QAAQ,IAAI,CAAC,CAAC,kBAAkB,EAAE,gBAAgB,IAAI,CAAC,OAAO;QAClE;QAEA,OAAO;IACX;AACJ;AAEO,eAAe,KAAK,OAAoB;IAC3C,IAAI;QACA,MAAM,EAAE,WAAW,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE1C,IAAI,CAAC,aAAa;YACd,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAwB,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,gBAAgB;QAChB,MAAM,YAAY,MAAM,IAAA,iIAAQ,EAAC,2BAA2B;QAC5D,MAAM,WAAW,KAAK,KAAK,CAAC;QAE5B,iBAAiB;QACjB,MAAM,YAAY,SAAS,UAAU,CAAC,IAAI,CAAC,CAAC,IAAW,EAAE,EAAE,KAAK;QAEhE,IAAI,CAAC,WAAW;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC7E;QAEA,QAAQ,GAAG,CAAC,CAAC,uBAAuB,EAAE,UAAU,IAAI,EAAE;QAEtD,gCAAgC;QAChC,MAAM,OAAO,MAAM;QAEnB,IAAI,KAAK,MAAM,KAAK,GAAG;YACnB,QAAQ,GAAG,CAAC;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBACrB,SAAS;gBACT,WAAW,UAAU,IAAI;gBACzB,SAAS,EAAE;gBACX,SAAS;YACb;QACJ;QAEA,kCAAkC;QAClC,MAAM,UAAU,MAAM,QAAQ,GAAG,CAAC,KAAK,GAAG,CAAC,OAAO;YAC9C,MAAM,cAAc,MAAM,eAAe,cAAc,CAAC,WAAW;YAEnE,OAAO;gBACH,OAAO,IAAI,EAAE;gBACb,UAAU,IAAI,KAAK;gBACnB,YAAY,IAAI,UAAU;gBAC1B,UAAU,IAAI,QAAQ;gBACtB,GAAG,WAAW;YAClB;QACJ;QAEA,oEAAoE;QACpE,IAAI,YAAY;QAEhB,6BAA6B;QAC7B,MAAM,cAAc,SAAS,UAAU,CAAC,IAAI,CAAC,CAAC,IAAW,EAAE,EAAE,KAAK;QAClE,IAAI,UAAU,SAAS,IAAI,CAAC,CAAC,YAAY,SAAS,IAAI,YAAY,SAAS,CAAC,MAAM,KAAK,CAAC,GAAG;YACvF,YAAY,SAAS,GAAG,UAAU,SAAS;YAC3C,YAAY;QAChB;QAEA,wBAAwB;QACxB,KAAK,OAAO,CAAC,CAAC;YACV,MAAM,QAAQ,SAAS,IAAI,CAAC,IAAI,CAAC,CAAC,IAAW,EAAE,EAAE,KAAK,IAAI,EAAE;YAC5D,IAAI,IAAI,SAAS,IAAI,SAAS,CAAC,CAAC,MAAM,SAAS,IAAI,MAAM,SAAS,CAAC,MAAM,KAAK,CAAC,GAAG;gBAC9E,MAAM,SAAS,GAAG,IAAI,SAAS;gBAC/B,YAAY;YAChB;QACJ;QAEA,4BAA4B;QAC5B,IAAI,CAAC,SAAS,OAAO,EAAE,SAAS,OAAO,GAAG,EAAE;QAE5C,QAAQ,OAAO,CAAC,CAAA;YACZ,SAAS,OAAO,CAAC,IAAI,CAAC;gBAClB,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,MAAM,KAAK,EAAE;gBACxC,aAAa,UAAU,EAAE;gBACzB,GAAG,KAAK;gBACR,WAAW,IAAI,OAAO,WAAW;YACrC;QACJ;QAEA,gBAAgB;QAChB,MAAM,IAAA,kIAAS,EAAC,2BAA2B,KAAK,SAAS,CAAC,UAAU,MAAM;QAE1E,QAAQ,GAAG,CAAC,CAAC,QAAQ,EAAE,QAAQ,MAAM,CAAC,uBAAuB,EAAE,UAAU,IAAI,EAAE;QAE/E,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB,SAAS;YACT,WAAW,UAAU,IAAI;YACzB;YACA,SAAS,CAAC,MAAM,EAAE,QAAQ,MAAM,CAAC,sBAAsB,CAAC;QAC5D;IAEJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,OAAO;QAAkB,GAC3B;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}